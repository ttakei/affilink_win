1. 使い方
リンク作成ツール.exeをクリックし、アプリケーションを立ち上げます。
検索対象のサイトを選択し(複数可)、商品名、JANコードを入力、そして出力先フォルダを選択します。
実行ボタンを押したら、出力先フォルダに、<JANコード>.tsvのファイルが作成されます。

2. フォルダ構成
.
│
│  リンク作成ツール.exe  …アプリケーション本体です
│  *.dll  …アプリケーション実行に必要なライブラリです
│  *.o  …アプリケーション実行に必要なライブラリです
│
├─doc
│      README.doc  …本ファイルです
│      README_開発者.doc  …開発者向けドキュメントです
│
├─conf
│      default.ini  …設定ファイルです
│
├─html  …アプリケーション実行の際取得したhtmlソースが格納されます
│
├─src  …ソースコードが格納されています
│
└─その他フォルダ  …アプリケーション実行に必要なライブラリが格納されています

3. 出力フォーマット
タブ区切りで、
<検索サイト名> <JANコード> <生成したリンク> <付加情報>
となります。

付加情報は、
<検索URL> <商品URL> <商品イメージURL> <商品値段> <商品情報抽出結果>
となります。
商品情報抽出結果は、商品URL、商品イメージURL、商品値段すべて抽出できた場合は成功、いずれかが抽出できなかった場合は、抽出商品情報不完全、と表記されます


4. 設定
アプリケーションの画面で設定した内容は、実行時に設定ファイルに反映されます。
設定ファイルは誤って削除してしまった場合、アプリケーション立ち上げ時に復元されます。
※ただし、復元された設定ファイルの中身は、初期内容となっており、カスタマイズした設定は失われますので、ご注意ください。

[global]
output_folder  …出力先フォルダです。アプリケーション画面からも設定できます
search_entry_list  …検索対象のリストです。idをカンマ区切りで指定します。

[_search_entry_<id>]
<id>はglobal/search_entry_listで指定したidを入れます。
検索対象の個数分、同設定項目を用意します。
name  …idに対する表示用名称です。アプリケーション画面の表示や、出力などに使用されます。
search_url_template  …検索URLのテンプレートです。:jancodeで、入力するJANコードの値を指定できます
regex_product_url  …検索ページhtmlから商品URL抽出に使用する正規表現です。()で囲った部分が商品URLとなります。ダブルクォーテーションは\でエスケープする必要があります。
regex_product_img_url  …検索ページhtmlから商品画像URL抽出に使用する正規表現です。()で囲った部分が商品URLとなります。ダブルクォーテーションは\でエスケープする必要があります。
regex_product_price_url  …検索ページhtmlから商品価格抽出に使用する正規表現です。()で囲った部分が商品URLとなります。ダブルクォーテーションは\でエスケープする必要があります。
prefix_product_url  …正規表現で抽出した商品URLの先頭に追加する文字列がある場合は指定します。
prefix_product_img_url  …正規表現で抽出した商品画像URLの先頭に追加する文字列がある場合は指定します。
link_template  …リンク用テンプレートです。以下の変数が使用できます。
  :jancode  …入力したJANコード
  :product_name  …入力した商品名
  :product_url  …商品URL
  :product_eurl  …商品URLをURLエンコードしたもの
  :product_no  …商品番号。あみあみ(楽天)用
  :product_img_url  …商品画像URL
  :product_price  …商品価格
enable  …検索するかしないかの設定です。true/falseを指定します。アプリケーション画面からも設定できます
